[{"title":"使用acme申请免费的HTTPS证书","date":"2020-12-11T10:10:26.000Z","path":"2020/12/11/acme/","text":"相关资料acme 文档Let’s Encrypt 证书颁发机构 安装acmecurl https://get.acme.sh | sh 默认安装目录在~/.acme.sh/ 安装过程中会自动为你创建 cronjob, 每天 0:09 点自动检测所有的证书, 如果快过期了, 需要更新, 则会自动更新证书。 9 0 * * * &quot;/root/.acme.sh&quot;/acme.sh --cron --home &quot;/root/.acme.sh&quot; &gt; /dev/null 可选参数–home 是要安装的自定义目录acme.sh。默认情况下，它安装到~/.acme.sh。–config-home 是一个可写文件夹，acme.sh将在其中写入所有文件（包括cert / keys，configs）。默认情况下–home。–cert-home 是自定义的目录，用于保存您颁发的证书。默认情况下，它保存在中–config-home。–accountemail 是用于向Let’s Encrypt注册帐户的电子邮件，您将在此处收到续订通知电子邮件。默认为空。–accountkey 是保存您帐户私钥的文件。默认情况下，它保存在中–config-home。–useragent 请求的用户代理头的值。 申请证书申请证书需要验证域名所有权 有三种方式验证 1.HTTP 方式HTTP方式需要在你的网站根目录下放置一个文件, 来验证你的域名所有权,完成验证。就可以生成证书了。–webroot 为你网站的根目录，acme会自动生成验证文件到网站根目录下，申请完成后会自动删除验证文件。-d 后面要申请证书的域名，可多个 缺点 不可申请泛域名 acme.sh --issue -d www.liangdonglin.cn --webroot /www/www.liangdonglin.cn 如果你用的是nginx或者apache,使用以下命令不需要指定网站根目录，它会自动根据配置完成验证。 acme.sh --issue -d www.liangdonglin.cn --nginx acme.sh --issue -d www.liangdonglin.cn --apache 1.DNS 方式需要添加DNS解析验证域名所有权缺点 使用这种方式无法自动更新证书优点1.可以申请泛域名2.可以在任意安装了acme的机器申请证书，只要在域名NS管理方添加一条TXT dns解析记录即可 申请证书acme.sh --issue -d *.liangdonglin.cn --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please [2020年 12月 18日 星期五 16:19:25 CST] Using CA: https://acme-v02.api.letsencrypt.org/directory [2020年 12月 18日 星期五 16:19:25 CST] Creating domain key [2020年 12月 18日 星期五 16:19:25 CST] The domain key is here: /root/.acme.sh/*.liangdonglin.cn/*.liangdonglin.cn.key [2020年 12月 18日 星期五 16:19:25 CST] Single domain=&#39;*.liangdonglin.cn&#39; [2020年 12月 18日 星期五 16:19:25 CST] Getting domain auth token for each domain [2020年 12月 18日 星期五 16:19:30 CST] Getting webroot for domain=&#39;*.liangdonglin.cn&#39; [2020年 12月 18日 星期五 16:19:30 CST] Add the following TXT record: [2020年 12月 18日 星期五 16:19:30 CST] Domain: &#39;_acme-challenge.liangdonglin.cn&#39; [2020年 12月 18日 星期五 16:19:30 CST] TXT value: &#39;86gDwJGcR26QvGkhl5oCZvFPL2Iv3FHEjLiZBCEBbyE&#39; [2020年 12月 18日 星期五 16:19:30 CST] Please be aware that you prepend _acme-challenge. before your domain [2020年 12月 18日 星期五 16:19:30 CST] so the resulting subdomain will be: _acme-challenge.liangdonglin.cn [2020年 12月 18日 星期五 16:19:30 CST] Please add the TXT records to the domains, and re-run with --renew. [2020年 12月 18日 星期五 16:19:30 CST] Please add &#39;--debug&#39; or &#39;--log&#39; to check more details. [2020年 12月 18日 星期五 16:19:30 CST] See: https://github.com/acmesh-official/acme.sh/wiki/How-to-debug-acme.sh 查看解析dig -t txt _acme-challenge.liangdonglin.cn @8.8.8.8 ; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-16.P2.el7_8.6 &lt;&lt;&gt;&gt; -t txt _acme-challenge.liangdonglin.cn @8.8.8.8 ;; global options: +cmd ;; Got answer: ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 57426 ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 512 ;; QUESTION SECTION: ;_acme-challenge.liangdonglin.cn. IN TXT ;; ANSWER SECTION: _acme-challenge.liangdonglin.cn. 299 IN TXT &quot;86gDwJGcR26QvGkhl5oCZvFPL2Iv3FHEjLiZBCEBbyE&quot; ;; Query time: 143 msec ;; SERVER: 8.8.8.8#53(8.8.8.8) ;; WHEN: 五 12月 18 16:32:25 CST 2020 ;; MSG SIZE rcvd: 116 完成验证，得到证书acme.sh --renew -d *.liangdonglin.cn --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please [2020年 12月 18日 星期五 16:44:33 CST] Renew: &#39;*.liangdonglin.cn&#39; [2020年 12月 18日 星期五 16:44:37 CST] Using CA: https://acme-v02.api.letsencrypt.org/directory [2020年 12月 18日 星期五 16:44:37 CST] Single domain=&#39;*.liangdonglin.cn&#39; [2020年 12月 18日 星期五 16:44:37 CST] Getting domain auth token for each domain [2020年 12月 18日 星期五 16:44:37 CST] Verifying: *.liangdonglin.cn [2020年 12月 18日 星期五 16:44:43 CST] Success [2020年 12月 18日 星期五 16:44:43 CST] Verify finished, start to sign. [2020年 12月 18日 星期五 16:44:43 CST] Lets finalize the order. [2020年 12月 18日 星期五 16:44:43 CST] Le_OrderFinalize=&#39;https://acme-v02.api.letsencrypt.org/acme/finalize/53165097/6806687071&#39; [2020年 12月 18日 星期五 16:44:46 CST] Downloading cert. [2020年 12月 18日 星期五 16:44:46 CST] Le_LinkCert=&#39;https://acme-v02.api.letsencrypt.org/acme/cert/04470ac32d4f7cab1dd89c1721e29ad85813&#39; [2020年 12月 18日 星期五 16:44:48 CST] Cert success. [2020年 12月 18日 星期五 16:44:48 CST] Your cert is in /root/.acme.sh/*.liangdonglin.cn/*.liangdonglin.cn.cer [2020年 12月 18日 星期五 16:44:48 CST] Your cert key is in /root/.acme.sh/*.liangdonglin.cn/*.liangdonglin.cn.key [2020年 12月 18日 星期五 16:44:48 CST] The intermediate CA cert is in /root/.acme.sh/*.liangdonglin.cn/ca.cer [2020年 12月 18日 星期五 16:44:48 CST] And the full chain certs is there: /root/.acme.sh/*.liangdonglin.cn/fullchain.cer API添加DNS验证文档优点 acme 自动调用域名解析商API自动添加DNS解析完成验证，能自动更新。以GoDaddy为列登录GoDaddy账号生成自己App_KEY和App_Secret export GD_Key=&quot;sdfsdfsdfljlbjkljlkjsdfoiwje&quot; export GD_Secret=&quot;asdfsdafdsfdsfdsfdsfdsafd&quot; acme.sh --issue --dns dns_gd -d example.com -d www.example.com 使用证书默认证书都是放在~/.acme.sh/，不建议直接使用此目录使用以下命令copy证书到自定义证书文件存放位置 以nginx为列 acme.sh --installcert -d &lt;domain&gt;.com \\ --key-file /etc/nginx/ssl/&lt;domain&gt;.key \\ --fullchain-file /etc/nginx/ssl/fullchain.cer \\ --reloadcmd &quot;service nginx force-reload&quot; server &#123; listen 80; server_name www.liangdonglin.cn; rewrite ^/(.*) https://www.liangdonglin.cn/$1 redirect; &#125; server &#123; listen 443 ssl; server_name www.liangdonglin.cn; index index.html; root /app/www; ssl_certificate /etc/nginx/ssl/fullchain.cer; ssl_certificate_key /etc/nginx/ssl/*.liangdonglin.cn.key; ssl_session_timeout 5m; ssl_protocols TLSv1.2 TLSv1.1 TLSv1; ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA:DES-CBC3-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4; ssl_session_cache shared:SSL:10m; ssl_prefer_server_ciphers on; location /&#123; root html; index index.html index.htm; &#125; &#125; 先检查nginx配置文件 nginx -t 最后重启nginx service nginx force-reload or nginx -s reload 更新acme手动更新acme.sh --upgrade 开启自动更新acme.sh --upgrade --auto-upgrade 关闭自动更新acme.sh --upgrade --auto-upgrade 0","tags":[{"name":"acme","slug":"acme","permalink":"http://liangdonglin.cn/tags/acme/"},{"name":"https","slug":"https","permalink":"http://liangdonglin.cn/tags/https/"}]},{"title":"Win7 安装.NET 阻塞问题解决办法","date":"2020-12-10T09:14:18.000Z","path":"2020/12/10/win7-net4.7/","text":"原因系统缺少（D3dcompiler_47.dll）文件 解决办法1.右击我的电脑，并点击‘属性’选项。 2.在Windows版本中，我们可以看到我们的系统是哪一版本的。 3.下载对应版本的补丁升级&ensp;Windows 7 SP1 x86 补丁更新包 下载地址&ensp;Windows 7 SP1 x64 补丁更新包 下载地址 4.重新安装 .NET4.7&ensp;中文简体在线下载包 下载地址&ensp;离线安装包 下载地址","tags":[{"name":"Win7","slug":"Win7","permalink":"http://liangdonglin.cn/tags/Win7/"},{"name":".NET","slug":"NET","permalink":"http://liangdonglin.cn/tags/NET/"}]}]